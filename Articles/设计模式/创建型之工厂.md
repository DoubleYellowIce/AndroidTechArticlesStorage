本篇文章是想讲一讲我对设计模式中三个设计模式，简单工厂，抽象工厂和工厂方法的个人理解，这三个都是工厂相关的，也都是从属于设计模式中的创建型，这就是标题为什么会取创建型之工厂的原因。

在日常生活中，工厂一般是用于生产产品的，而在程序设计里面，则可以生产产品理解为类的实例化，所以这三个设计模式都与类的实例化有着密切的联系。

### 简单工厂

该设计模式的类图如下所示（图片来源见水印，下同）。

<div align="center"> <img src="https://cs-notes-1256109796.cos.ap-guangzhou.myqcloud.com/40c0c17e-bba6-4493-9857-147c0044a018.png"/> </div><br>

一个抽象产品有多个子类产品，将子类产品的实例化代码抽取出来单独放到一个类中，这就是简单工厂。

简单工厂的核心就是简单，简单工厂仅负责决定要实例化哪一个子类产品，职责明确单一。

尽管简单，但是简单工厂有不小的好处。

- 解耦合。当子类产品有多个时，客户类不需要知道产品的细节，只需调用简单工厂的方法来获取实例。
- 方便维护。当实例化逻辑发生改变时，只需改动简单工厂中的方法。

### 工厂方法

该设计模式的类图如下所示。

<div align="center"> <img src="https://cs-notes-1256109796.cos.ap-guangzhou.myqcloud.com/f4d0afd0-8e78-4914-9e60-4366eaf065b5.png"/> </div><br>

同样地，在工厂方法，一个抽象产品有多个子类产品，但与简单工厂方法不同，其将产品的实例化步骤延迟到了子类工厂中。

### 抽象工厂模式

该设计模式的类图如下所示。

<div align="center"> <img src="https://cs-notes-1256109796.cos.ap-guangzhou.myqcloud.com/e2190c36-8b27-4690-bde5-9911020a1294.png"/> </div><br>

从上图可以看到，抽象工厂与其它两个工厂设计模式最大的不同点在于，其有不止一个抽象产品。

抽象工厂用于实例化产品家族，那什么是产品家族呢？以上图为例子，ProductA1和ProductA2就是产品家族，该产品家族由ConcreteFactory1负责实例化。

再举一个生活中的例子，自己DIY过电脑主机的小伙伴应该知道，电脑主机需要主板，CPU，显卡，电源等等配件，假设华硕有一个工厂负责所有主机配件的生产，那么这些由华硕工厂生产出来的主机配件都会印有华硕LOGO，尽管很多品牌都有能力生产主机配件，但是它们生产出来的产品不会印着华硕的LOGO，而是自家品牌的LOGO，这些印有同一品牌的LOGO，凑起来能组装成一台主机的配件产品就叫产品家族。

需要注意的是，抽象工厂用到了工厂方法设计模式，因为其也将产品的实例化延迟到了子类工厂中，但其与工厂方法的不同之处在于，工厂方法生产的是单一产品，而抽象工厂生产的是产品家族。

### 如何避免混淆三个设计模式

之所以将这三个设计模式放在一起讲，主要还是因为它们比较相似，容易混淆。

这三个设计模式有一个相同之处，就是负责实例化有多个子类产品的抽象产品。

如果只能用一个字分别来形容三个工厂设计模式的特点，我会用：

- `简`来形容简单工厂模式。结合共同点，很容易回想起来其简单的点就在于该工厂只负责决定要实例化哪个子类产品。
- `子`来形容工厂方法。结合共同点，就可以回想起来其将实例化步骤延迟到了子类工厂中。
- `族`来形容抽象工厂方法。结合共同点，就可以回想起来其用于实例化产品家族。

### 参考资料

1. [设计模式](https://github.com/CyC2018/CS-Notes/blob/master/notes/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%20-%20%E7%9B%AE%E5%BD%95.md)